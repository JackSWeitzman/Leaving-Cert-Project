<!DOCTYPE html>
<html id="1" lang="en">
<head>
    <!-- Meta Data -->
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Linking Font Type, Sizes and Weight From Google -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Links Style Sheets -->
    <link rel="stylesheet" href="CSS/general.css">
    <link rel="stylesheet" href="CSS/style.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <!-- Website Tab Title -->
    <title>Door Alarm</title>
</head>
<body>  
    <!-- Website Header -->
    <header class="header">
        <a href="index.html">
        <img class="logo" alt="Company logo" src="Images/Logo/SAFE logo.png">
        </a>
        <!-- Primary Navigation Menu -->
        <nav class="main-nav">
            <!-- List -->
            <ul class="main-nav-list">
                <!-- Links -->
                <li><a class="main-nav-link" href="index.html">Home</a></li>
                <li><a class="main-nav-link" href="the product.html">The Product</a></li>
                <li><a class="main-nav-link" href="how it works.html">How It Works</a></li>
                <li><a class="main-nav-link" href="live feed.html">Live Feed</a></li>
                <li><a class="main-nav-link nav-cta" href="sign up.html">Sign Up</a></li>
            </ul>
        </nav>
    </header>

    <!-- Live Activity Feed Section -->
    <body>
    <section class="section-feed">
        <div class="container">
            <span class="subheading">Live Feed</span>
            <h2 class="heading-secondary">
                Recent Product Activity Feed
            </h2>
        </div>
        <!-- Where data from Firebase will be displayed -->
        <div class="container mt-3">
            <!-- Creates a table to display the data -->
            <table class="table table-dark">
                <thead>
                    <th>SystemCheckNo</th>
                    <th>System State</th>

                </thead>
                <tbody id="tbody1"></tbody>
            </table>
        </div>
    </section>
    </body>
    
    <!-- Footer Section -->
    <footer class="footer">
        <!-- Puts everything into a 5 column grid container -->
        <div class="container grid grid-footer">
            <div class="logo-col">
                <a href="#" class="footer-logo">
                    <img class="logo" alt="Company logo" src="Images/Logo/SAFE logo.png">
                </a>
                <p class="copyright">Copyright &copy; 2027 by SAFE Inc. All rights reserved.</p>
            </div>

            <!-- Address, Email and Phone Number - Contact Us -->
            <div class="address-col">
                <p class="footer-heading">Contact Us</p>
                <address class="contact-info">
                <p class="address">
                    Address: 123 Linear St., 3rd Floor, Unsafe Town, Co. Risky 94107
                </p>
                <p>
                    <a class="footer-link" href="tel:555-555-5555">555-555-5555</a><br>
                    <a class="footer-link" href="mailto:hello@safecorporation.com">hello@safecorporation.com</a>
                </p>
                </address>
            </div>
            <!-- Footer Navigation Menu - Company --> 
            <nav class="nav-col">
                <p class="footer-heading">
                    Company
                </p>
                <!-- List -->
                <ul class="footer-nav">
                    <li><a class="footer-link" href="#">About SAFE</a></li>
                    <li><a class="footer-link" href="#">For Business</a></li>
                    <li><a class="footer-link" href="#">Careers</a></li>
                </ul>
            </nav>
            <!-- Footer Navigation Menu - Resources -->
            <nav class="nav-col">
                <p class="footer-heading">
                    Resources
                </p>
                <!-- List -->
                <ul class="footer-nav">
                    <li><a class="footer-link" href="sign up.html">Newsletter</a></li>
                    <li><a class="footer-link" href="#">Help center</a></li>
                    <li><a class="footer-link" href="#">Privacy & terms</a></li>
                </ul>
            </nav>
            <!-- Footer Navigation Menu - Accessibility -->
            <nav class="nav-col">
                <p class="footer-heading">
                    Accessibility
                </p>
                <!-- List -->
                <ul class="footer-nav">
                    <!-- Buttons which, when pressed, will activate their respective JavaScript function -->
                    <button id="colorBlind" class="footer-link footer-button" onclick="colorBlindMode()">Color Blind Mode</button>
                    <button id="increase" class="footer-link footer-button" onclick="increase()">Increase Font Size</button>
                    <button id="decrease" class="footer-link footer-button" onclick="decrease()">Decrease Font Size</button>
                </ul>
            </nav>

        </div>
    </footer>    
</body>
<!-- JavaScript Code -->
<script>
    // Color Blind Mode //
    function colorBlindMode(){
        document.getElementById("1").style.webkitFilter="grayscale(100%)";
    }

    // Increase Font Size //
    function increase(){
        document.getElementById("1").style.fontSize="90%";
    }

    // Decrease Font Size //
    function decrease(){
        document.getElementById("1").style.fontSize="50%";
    }
</script>
<script type="module">
// Code to display data from Firebase on the table //
            var SystemCheckNo = 0;
            var tbody = document.getElementById('tbody1');

            function AddItemToTable(System){
                let trow = document.createElement("tr");
                let td1 = document.createElement("td");
                let td2 = document.createElement("td");
                let td3 = document.createElement("td");

                td1.innerHTML=++SystemCheckNo;
                td2.innerHTML= System;
                

                trow.appendChild(td1);
                trow.appendChild(td2);
                trow.appendChild(td3);
                

                tbody.appendChild(trow);
            }
            
            function AddAllItemsToTable(System){
                SystemCheckNo=0;
                tbody.innerHTML="";
                System.forEach(element=> {
                    AddItemToTable(element.System, element.Timestamp);


                });

            }
            
                    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.5/firebase-app.js";
                   

                    // Your web app's Firebase configuration
                    const firebaseConfig = {
                        apiKey: "AIzaSyBNCHBlQ33cSS2PGQDlnJu2RPcYLyAYeSU",
                        authDomain: "lccs-project-2557f.firebaseapp.com",
                        databaseURL: "https://lccs-project-2557f-default-rtdb.firebaseio.com",
                        projectId: "lccs-project-2557f",
                        storageBucket: "lccs-project-2557f.appspot.com",
                        messagingSenderId: "278365208418",
                        appId: "1:278365208418:web:50b1b4584bff6c2928363b",
                        measurementId: "G-PK210HMWHZ"
                    };

                    // Initialize Firebase
                    const app = initializeApp(firebaseConfig);

                    import {getDatabase, ref, child, onValue, get}
                    from "https://www.gstatic.com/firebasejs/9.6.5/firebase-database.js";

                    const db = getDatabase();

// Retrieving The Data To Display On The Table // 

        function GetAllDataOnce(){
            const dbRef = ref(db);

            get(child(dbRef,"alarmData/systemState/"))
            .then((snapshot)=>{
                var systems =[];
                
                snapshot.forEach(childSnapshot => {
                    systems.push(childSnapshot.val());

                });
                AddAllItemsToTable(systems);

            });

        }


        function GetAllDataRealtime(){
            const dbRef = ref(db,"alarmData/systemState");

            onValue(dbRef,(snapshot)=>{
                var systems =[];
                
                snapshot.forEach(childSnapshot => {
                    systems.push(childSnapshot.val());

                });

                AddAllItemsToTable(systems);


            })

            

        }
        window.onload = GetAllDataRealtime;
        </script>
</html>